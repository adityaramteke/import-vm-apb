FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGltcG9ydC12bS1hcGIKZGVzY3JpcHRpb246IEltcG9ydCBWaXJ0\
dWFsIE1hY2hpbmUKYmluZGFibGU6IEZhbHNlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0YToKICBk\
aXNwbGF5TmFtZTogSW1wb3J0IFZNIChBUEIpCiAgaW1hZ2VVcmw6IGh0dHBzOi8vY2RuLnBicmQu\
Y28vaW1hZ2VzL0g1R3V0ZDcucG5nCnBsYW5zOgogIC0gbmFtZTogdm13YXJlCiAgICBkZXNjcmlw\
dGlvbjogVXNlIHYydiB0byBpbXBvcnQgYSBWaXJ0dWFsIE1hY2hpbmUgZnJvbSBWTVdhcmUgdkNl\
bnRlcgogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBJbXBv\
cnQgZnJvbSBWTVdhcmUKICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gdGl0bGU6IFZNd2FyZSB1cmwg\
dG8gRVhTaQogICAgICAgIG5hbWU6IHVybAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJl\
cXVpcmVkOiB0cnVlCiAgICAgIC0gdGl0bGU6IFZpcnR1YWwgbWFjaGluZSBuYW1lCiAgICAgICAg\
bmFtZTogdm1fbmFtZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVl\
CiAgICAgIC0gdGl0bGU6IFZNd2FyZSBBZG1pbgogICAgICAgIG5hbWU6IHVzZXJuYW1lCiAgICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkaXNwbGF5X3R5\
cGU6IHVzZXJuYW1lCiAgICAgIC0gdGl0bGU6IFZNd2FyZSBBZG1pbiBQYXNzd29yZAogICAgICAg\
IG5hbWU6IHBhc3N3b3JkCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRy\
dWUKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgLSBuYW1lOiB1cmwKICAgIGRlc2Ny\
aXB0aW9uOiBDcmVhdGUgYSBWaXJ0dWFsIE1hY2hpbmUgZnJvbSBhIGRvd25sb2FkZWQgZGlzayBp\
bWFnZQogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBJbXBv\
cnQgZnJvbSBVUkwKICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gdGl0bGU6IE9wZW5zaGlmdCBBZG1p\
biBVc2VyCiAgICAgICAgbmFtZTogYWRtaW5fdXNlcgogICAgICAgIHR5cGU6IHN0cmluZwogICAg\
ICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gdGl0bGU6IE9wZW5zaGlmdCBBZG1pbiBQYXNzd29y\
ZAogICAgICAgIG5hbWU6IGFkbWluX3Bhc3N3b3JkCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAg\
ICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgIC0g\
dGl0bGU6IERpc2sgSW1hZ2UgVVJMCiAgICAgICAgbmFtZTogZGlza19pbWFnZV91cmwKICAgICAg\
ICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIHRpdGxlOiBWaXJ0\
dWFsIE1hY2hpbmUgVHlwZQogICAgICAgIG5hbWU6IHZtX3R5cGUKICAgICAgICB0eXBlOiBlbnVt\
CiAgICAgICAgZW51bTogWydkZWZhdWx0J10KICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAg\
IGRlZmF1bHQ6IGRlZmF1bHQKICAgICAgICBkaXNwbGF5X3R5cGU6IHNlbGVjdAogICAgICAtIHRp\
dGxlOiBWaXJ0dWFsIE1hY2hpbmUgTmFtZQogICAgICAgIG5hbWU6IHZtX25hbWUKICAgICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIHRpdGxlOiBOdW1iZXIg\
b2YgQ1BVcwogICAgICAgIG5hbWU6IG5yX2NwdXMKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAg\
ICAgIHR5cGU6IGludAogICAgICAgIGRlZmF1bHQ6IDEKICAgICAgLSB0aXRsZTogTWVtb3J5IChp\
biBNZWdhYnl0ZXMpCiAgICAgICAgbmFtZTogbWVtCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAg\
ICAgICB0eXBlOiBpbnQKICAgICAgICBkZWZhdWx0OiAxMDI0Cg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
